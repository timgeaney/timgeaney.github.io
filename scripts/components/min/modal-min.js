jQuery(document).ready(function($){function n(n){var t=n.width()/2,o=n.offset().left+t,s=n.offset().top+t-$(window).scrollTop(),e=i(s,o,t,$(window).height(),$(window).width());return n.css("position","fixed").velocity({top:s-t,left:o-t,translateX:0},0),e}function i(n,i,t,o,s){var e=i>o/2?i:o-i,a=n>s/2?n:s-n;return Math.ceil(Math.sqrt(Math.pow(e,2)+Math.pow(a,2))/t)}function t(n,i,t){n.velocity({scale:i},400,function(){$("body").toggleClass("overflow-hidden",t),t?n.parents(".bh-section").addClass("modal-is-visible").end().off("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend"):n.removeClass("is-visible").removeAttr("style").siblings('[data-type="modal-trigger"]').removeClass("to-circle")})}function o(){var n=$(".bh-section.modal-is-visible").find(".bh-modal-bg"),t=n.width()/2,o=n.siblings(".btn").offset().top+t-$(window).scrollTop(),s=n.siblings(".btn").offset().left+t,e=i(o,s,t,$(window).height(),$(window).width());n.velocity({top:o-t,left:s-t,scale:e},0)}function s(){var n=$(".bh-section.modal-is-visible");n.removeClass("modal-is-visible").one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){t(n.find(".bh-modal-bg"),1,!1)}),n.parents(".no-csstransitions").length>0&&t(n.find(".bh-modal-bg"),1,!1)}$('[data-type="modal-trigger"]').on("click",function(){var i=$(this),o=n(i.next(".bh-modal-bg"));i.addClass("to-circle"),i.next(".bh-modal-bg").addClass("is-visible").one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){t(i.next(".bh-modal-bg"),o,!0)}),i.parents(".no-csstransitions").length>0&&t(i.next(".bh-modal-bg"),o,!0)}),$(".bh-section .bh-modal-close").on("click",function(){s()}),$(document).keyup(function(n){"27"==n.which&&s()}),$(window).on("resize",function(){$(".bh-section.modal-is-visible").length>0&&window.requestAnimationFrame(o)})});